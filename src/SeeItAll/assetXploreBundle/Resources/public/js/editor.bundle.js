(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{142:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if(!a||!i)return;const e=new window.Image;e.src=t.image,e.onload=(()=>{document.body.style.overflow="hidden",a.style.display="block",r.value=t.name,i.annotate({width:a.clientWidth,height:a.clientWidth*e.height/e.width,images:[t.image],onExport:m})})};var o=function(t){return t&&t.__esModule?t:{default:t}}(n(152));n(183),n(182);const i=(0,o.default)("#editor-image"),a=document.getElementById("editor-container"),r=document.getElementById("editor-name"),s=document.getElementById("editor-cancel"),d=document.getElementById("editor-save"),l=document.getElementById("save-image-container"),h=document.getElementById("save-image-input-image"),c=document.getElementById("save-image-cancel"),p=document.getElementById("save-image-tag");function m(t){l.style.display="flex",p.setAttribute("src",t),h.value=t}c&&c.addEventListener("click",()=>{document.body.style.overflow="scroll",l.style.display="none"}),s&&s.addEventListener("click",function(){a&&i&&(document.body.style.overflow="scroll",a.style.display="none",i.annotate("destroy"))}),d&&d.addEventListener("click",()=>{i.annotate("export",{type:"image/jpeg",quality:.75})})},174:function(t,e){t.exports="\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='19' height='18' viewBox='0 0 19 18'%3E %3Cpath fill='%23FFF' d='M175,18.0025 C173.34,18.0025 172,19.3425 172,21.0025 C172,22.3125 170.84,23.0025 170,23.0025 C170.92,24.2225 172.49,25.0025 174,25.0025 C176.21,25.0025 178,23.2125 178,21.0025 C178,19.3425 176.66,18.0025 175,18.0025 Z M188.71,8.6325 L187.37,7.2925 C186.98,6.9025 186.35,6.9025 185.96,7.2925 L177,16.2525 L179.75,19.0025 L188.71,10.0425 C189.1,9.6525 189.1,9.0225 188.71,8.6325 Z' transform='translate(-170 -7)'/%3E %3C/svg%3E\""},175:function(t,e){t.exports="\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='19' height='19' viewBox='0 0 19 19'%3E %3Cpath fill='%23FFF' fill-rule='evenodd' d='M232.242641,15.4142136 L223.050253,24.6066017 C222.659728,24.997126 222.026563,24.997126 221.636039,24.6066017 L219.393398,22.363961 C219.002874,21.9734367 219.002874,21.3402718 219.393398,20.9497475 L228.585786,11.7573593 L224.757359,7.92893219 L237.485281,6.51471863 L236.071068,19.2426407 L232.242641,15.4142136 Z' transform='translate(-219 -6)'/%3E %3C/svg%3E\""},176:function(t,e){t.exports="\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='15' viewBox='0 0 14 15'%3E %3Cpolygon fill='%23FFF' points='124 9 124 12 129.5 12 129.5 24 132.5 24 132.5 12 138 12 138 9' transform='translate(-124 -9)'/%3E %3C/svg%3E\""},177:function(t,e){t.exports="\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='17' height='17' viewBox='0 0 17 17'%3E %3Ccircle cx='665.5' cy='28.5' r='7.5' fill='none' stroke='%23FFF' stroke-width='2' transform='translate(-657 -20)'/%3E %3C/svg%3E\""},178:function(t,e){t.exports="\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='17' height='17' viewBox='0 0 17 17'%3E %3Crect width='15' height='15' x='658' y='21' fill='none' stroke='%23FFF' stroke-width='2' rx='1' transform='translate(-657 -20)'/%3E %3C/svg%3E\""},179:function(t,e){t.exports="\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='19' height='16' viewBox='0 0 19 16'%3E %3Cpath fill='%23FFF' fill-rule='evenodd' d='M82.4688767,13.3099718 L77.1355799,8.1900013 C77.0035068,8.06333377 76.8472694,8 76.6667397,8 C76.48621,8 76.3298447,8.06333377 76.1980274,8.1900013 C76.0660822,8.31679158 75.9999817,8.46677969 75.9999817,8.64008837 L75.9999817,11.2000736 L73.6666484,11.2000736 C68.7151233,11.2000736 65.6770594,12.5434614 64.5519452,15.2301142 C64.1839817,16.1234149 64,17.2334742 64,18.5601694 C64,19.666792 64.440968,21.1701098 65.3229041,23.0701228 C65.3437443,23.1168867 65.3800548,23.1966676 65.4322192,23.3099565 C65.4843836,23.4232454 65.5311781,23.5232784 65.5728584,23.6099327 C65.6146667,23.6965871 65.6597991,23.7699855 65.7083836,23.8298826 C65.7916164,23.9432942 65.8889132,24 66.0000183,24 C66.1042192,24 66.18579,23.9667375 66.2448584,23.9000898 C66.3037991,23.833442 66.3333333,23.7499789 66.3333333,23.6501914 C66.3333333,23.5901716 66.3246393,23.5019216 66.3072511,23.385196 C66.289863,23.2684704 66.2811689,23.1901624 66.2811689,23.1502719 C66.2463927,22.6969936 66.2290046,22.286797 66.2290046,21.9202958 C66.2290046,21.2470677 66.289863,20.6436785 66.4113242,20.1103738 C66.5329132,19.5769464 66.7012968,19.1154445 66.9166027,18.7253772 C67.1319087,18.3351872 67.4096073,17.9986345 67.7499543,17.7153509 C68.0901735,17.4320673 68.4564749,17.2004572 68.8488584,17.0203978 C69.241242,16.8403385 69.7030502,16.6986967 70.2342831,16.5953497 C70.765516,16.4920027 71.3002009,16.4203227 71.8384658,16.3803095 C72.3767306,16.3402963 72.9860822,16.3204124 73.6666484,16.3204124 L75.9999817,16.3204124 L75.9999817,18.8803977 C75.9999817,19.0537064 76.0659543,19.2038172 76.1977717,19.330362 C76.3298447,19.4569068 76.4860822,19.5203633 76.666484,19.5203633 C76.8470137,19.5203633 77.003379,19.4569068 77.1354521,19.330362 L82.4687489,14.2102687 C82.6006941,14.0836012 82.6666667,13.9336131 82.6666667,13.7603044 C82.6666667,13.5869957 82.6006941,13.4368849 82.4688767,13.3099718 L82.4688767,13.3099718 Z' transform='translate(-64 -8)'/%3E %3C/svg%3E\""},180:function(t,e){t.exports="\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='19' height='16' viewBox='0 0 19 16'%3E %3Cpath fill='%23FFF' fill-rule='evenodd' d='M33.4688767,13.3099718 L28.1355799,8.1900013 C28.0035068,8.06333377 27.8472694,8 27.6667397,8 C27.48621,8 27.3298447,8.06333377 27.1980274,8.1900013 C27.0660822,8.31679158 26.9999817,8.46677969 26.9999817,8.64008837 L26.9999817,11.2000736 L24.6666484,11.2000736 C19.7151233,11.2000736 16.6770594,12.5434614 15.5519452,15.2301142 C15.1839817,16.1234149 15,17.2334742 15,18.5601694 C15,19.666792 15.440968,21.1701098 16.3229041,23.0701228 C16.3437443,23.1168867 16.3800548,23.1966676 16.4322192,23.3099565 C16.4843836,23.4232454 16.5311781,23.5232784 16.5728584,23.6099327 C16.6146667,23.6965871 16.6597991,23.7699855 16.7083836,23.8298826 C16.7916164,23.9432942 16.8889132,24 17.0000183,24 C17.1042192,24 17.18579,23.9667375 17.2448584,23.9000898 C17.3037991,23.833442 17.3333333,23.7499789 17.3333333,23.6501914 C17.3333333,23.5901716 17.3246393,23.5019216 17.3072511,23.385196 C17.289863,23.2684704 17.2811689,23.1901624 17.2811689,23.1502719 C17.2463927,22.6969936 17.2290046,22.286797 17.2290046,21.9202958 C17.2290046,21.2470677 17.289863,20.6436785 17.4113242,20.1103738 C17.5329132,19.5769464 17.7012968,19.1154445 17.9166027,18.7253772 C18.1319087,18.3351872 18.4096073,17.9986345 18.7499543,17.7153509 C19.0901735,17.4320673 19.4564749,17.2004572 19.8488584,17.0203978 C20.241242,16.8403385 20.7030502,16.6986967 21.2342831,16.5953497 C21.765516,16.4920027 22.3002009,16.4203227 22.8384658,16.3803095 C23.3767306,16.3402963 23.9860822,16.3204124 24.6666484,16.3204124 L26.9999817,16.3204124 L26.9999817,18.8803977 C26.9999817,19.0537064 27.0659543,19.2038172 27.1977717,19.330362 C27.3298447,19.4569068 27.4860822,19.5203633 27.666484,19.5203633 C27.8470137,19.5203633 28.003379,19.4569068 28.1354521,19.330362 L33.4687489,14.2102687 C33.6006941,14.0836012 33.6666667,13.9336131 33.6666667,13.7603044 C33.6666667,13.5869957 33.6006941,13.4368849 33.4688767,13.3099718 L33.4688767,13.3099718 Z' transform='matrix(-1 0 0 1 33.667 -8)'/%3E %3C/svg%3E\""},181:function(t,e,n){var o=n(3);(t.exports=n(1)(!1)).push([t.i,"/**\n * App > Editor > Styles\n */\n\n/**\n * Shared > Styles > Animations\n */\n\n@-webkit-keyframes popup {\n  0% {\n    opacity: 0;\n    -webkit-transform: translateY(20px);\n    transform: translateY(20px);\n  }\n\n  100% {\n    opacity: 1;\n    -webkit-transform: translateY(0);\n    transform: translateY(0);\n  }\n}\n\n@keyframes popup {\n  0% {\n    opacity: 0;\n    -webkit-transform: translateY(20px);\n    transform: translateY(20px);\n  }\n\n  100% {\n    opacity: 1;\n    -webkit-transform: translateY(0);\n    transform: translateY(0);\n  }\n}\n\n@-webkit-keyframes fade {\n  0% {\n    opacity: 0;\n  }\n\n  100% {\n    opacity: 1;\n  }\n}\n\n@keyframes fade {\n  0% {\n    opacity: 0;\n  }\n\n  100% {\n    opacity: 1;\n  }\n}\n\n/**\n * Shared > Styles > Constants\n */\n\n.editor-container {\n  z-index: 50;\n  position: fixed;\n  top: 0;\n  left: 200px;\n  right: 0;\n  bottom: 0;\n  background-color: black;\n  -webkit-animation: popup 0.3s;\n  animation: popup 0.3s;\n  display: none;\n}\n\n.editor-image {\n  z-index: 1;\n  position: absolute;\n  margin-top: 52px;\n  top: 50%;\n  left: 50%;\n  -webkit-transform: translate(-50%, -50%);\n  transform: translate(-50%, -50%);\n  cursor: 'crosshair';\n}\n\n.editor-image-base {\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 1;\n  background: black;\n}\n\n.editor-image-drawing {\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 2;\n}\n\n.editor-textarea {\n  position: absolute;\n  z-index: 100;\n  display: none;\n  top: 0;\n  left: 0;\n  background: transparent;\n  border: 1px dotted;\n  line-height: 25px;\n  word-wrap: break-word;\n  outline-width: 0;\n  overflow: hidden;\n  padding: 0;\n}\n\n.editor-toolbar {\n  z-index: 2;\n  position: relative;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n  -ms-flex-flow: row wrap;\n  flex-flow: row wrap;\n  padding: 10px 10px 5px;\n  background-color: black;\n}\n\n.editor-name {\n  margin: 0 5px 8px 0;\n  border: 0;\n  color: white;\n  font-size: 14px;\n  font-weight: 700;\n  background-color: rgba(240, 243, 246, 0.2);\n}\n\n.editor-button {\n  display: block;\n  position: relative;\n  -ms-flex-negative: 0;\n  flex-shrink: 0;\n  height: 32px;\n  min-width: 48px;\n  border-radius: 4px;\n  color: white;\n  font-size: 14px;\n  font-weight: 700;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  background-color: rgba(240, 243, 246, 0.2);\n  margin-bottom: 8px;\n}\n\n.editor-button::after {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  opacity: 0.8;\n  background-position: 50% 50%;\n  background-repeat: no-repeat;\n}\n\n.editor-button:hover {\n  cursor: pointer;\n  background-color: rgba(240, 243, 246, 0.25);\n}\n\n.editor-button:hover::after {\n  opacity: 1;\n}\n\n.editor-button:active {\n  background-color: rgba(240, 243, 246, 0.2);\n}\n\n.editor-button:active::after {\n  opacity: 0.8;\n}\n\n.editor-button.on {\n  background-color: #147efb;\n}\n\n.editor-button.on::after {\n  opacity: 1;\n}\n\n.editor-button.undo::after {\n  background-image: url("+o(n(180))+");\n}\n\n.editor-button.redo::after {\n  background-image: url("+o(n(179))+");\n}\n\n.editor-button.rectangle::after {\n  background-image: url("+o(n(178))+");\n}\n\n.editor-button.circle::after {\n  background-image: url("+o(n(177))+");\n}\n\n.editor-button.text::after {\n  background-image: url("+o(n(176))+");\n}\n\n.editor-button.arrow::after {\n  background-image: url("+o(n(175))+");\n}\n\n.editor-button.pen::after {\n  background-image: url("+o(n(174))+");\n}\n\n.editor-button.cancel {\n  width: 80px;\n  margin-right: 5px;\n  margin-left: auto;\n}\n\n.editor-button.save {\n  width: 80px;\n  color: white;\n  background-color: #147efb;\n}\n\n.editor-button.save:hover:enabled {\n  background-color: hsl(212.46753246753246, 96.6527196653%, 50%);\n}\n\n.editor-button.save:active:enabled {\n  background-color: hsl(212.46753246753246, 96.6527196653%, 45%);\n}\n\n.editor-button-set {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n  -ms-flex-flow: row nowrap;\n  flex-flow: row nowrap;\n  margin-right: 8px;\n}\n\n.editor-button-set .editor-button {\n  border-radius: 0;\n  margin-right: 1px;\n}\n\n.editor-button-set .editor-button:first-child {\n  border-radius: 4px 0 0 4px;\n}\n\n.editor-button-set .editor-button:last-child {\n  border-radius: 0 4px 4px 0;\n}\n\n@media (max-width: 700px) {\n  .editor-container {\n    left: 0;\n  }\n\n  .editor-toolbar {\n    padding-left: 8px;\n    padding-right: 8px;\n  }\n\n  .editor-name {\n    width: 100%;\n    margin-right: 0;\n  }\n\n  .editor-button-set {\n    margin-left: 0;\n  }\n}",""])},182:function(t,e,n){var o=n(181);"string"==typeof o&&(o=[[t.i,o,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(0)(o,i);o.locals&&(t.exports=o.locals)},183:function(t,e,n){"use strict";!function(t){function e(e,n){this.options=n,this.$el=t(e),this.clicked=!1,this.fromx=null,this.fromy=null,this.fromxText=null,this.fromyText=null,this.tox=null,this.toy=null,this.points=[],this.storedUndo=[],this.storedElement=[],this.images=[],this.img=null,this.selectedImage=null,this.currentWidth=null,this.currentHeight=null,this.selectImageSize={},this.compensationWidthRate=1,this.linewidth=1,this.fontsize=1,this.init()}e.prototype={init(){const e=this;e.linewidth=e.options.linewidth,e.fontsize=e.options.fontsize,e.baseLayerId="baseLayer",e.drawingLayerId="drawingLayer",e.$el.append(t(`<canvas id="${e.baseLayerId}" class="editor-image-base"></canvas>`)),e.$el.append(t(`<canvas id="${e.drawingLayerId}" class="editor-image-drawing"></canvas>`)),e.baseCanvas=document.getElementById(e.baseLayerId),e.drawingCanvas=document.getElementById(e.drawingLayerId),e.baseContext=e.baseCanvas.getContext("2d"),e.drawingContext=e.drawingCanvas.getContext("2d"),e.baseContext.lineJoin="round",e.drawingContext.lineJoin="round",e.$tool=t("#editor-toolbar"),e.$textbox=t(`<textarea\n        class="editor-textarea"\n        style="color:${e.options.color};font-size:${e.fontsize}"></textarea>`),t("body").append(e.$textbox),e.initBackgroundImages(),e.$tool.on("click",'button[name^="tool"]',function(){t(`[data-tool="${e.options.type}"]`).removeClass("on"),t(this).addClass("on"),e.selectTool(t(this))}),t(`[data-tool="${e.options.type}"]`).trigger("click"),e.$tool.on("click",".redo",t=>{e.redoaction(t)}),e.$tool.on("click",".undo",t=>{e.undoaction(t)}),t(document).on(e.options.selectEvent,".annotate-image-select",function(n){n.preventDefault();const o=e.selectBackgroundImage(t(this).attr(e.options.idAttribute));e.setBackgroundImage(o)}),t(`#${e.drawingLayerId}`).on("mousedown touchstart",t=>{e.annotatestart(t)}),t(`#${e.drawingLayerId}`).on("mouseup touchend",t=>{e.annotatestop(t)}),t(`#${e.drawingLayerId}`).on("mouseleave touchleave",t=>{e.annotateleave(t)}),t(`#${e.drawingLayerId}`).on("mousemove touchmove",t=>{e.annotatemove(t)}),t(window).on("resize",()=>{e.annotateresize()}),e.checkUndoRedo()},generateId(t){const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split(""),n=e.length;t||(t=Math.floor(Math.random()*n));let o="";for(let i=0;i<t;i++)o+=e[Math.floor(Math.random()*n)];return o},addElements(t,e,n){this.storedElement=t,this.clear(),this.redraw()},pushImage(t,e,n){const o=this;let i=null,a=null;if("object"==typeof t?(i=t.id,a=t.path):(i=t,a=t),""===i||void 0===i||o.selectBackgroundImage(i))for(i=o.generateId(10);o.selectBackgroundImage(i);)i=o.generateId(10);const r={id:i,path:a,storedUndo:[],storedElement:[]};o.images.push(r),e&&o.setBackgroundImage(r),n&&n({id:r.id,path:r.path}),o.$el.trigger("annotate-image-added",[r.id,r.path])},initBackgroundImages(){const e=this;t.each(e.options.images,(t,n)=>{let o=!1;0===t&&(o=!0),e.pushImage(n,o)})},selectBackgroundImage(e){return t.grep(this.images,t=>t.id===e)[0]},setBackgroundImage(t){const e=this;e.$textbox.is(":visible")&&e.pushText();const n=e.selectBackgroundImage(e.selectedImage);n&&(n.storedElement=e.storedElement,n.storedUndo=e.storedUndo),e.img=new window.Image,e.img.src=t.path,e.img.onload=function(){e.currentWidth=e.options.width,e.currentHeight=e.options.height,e.selectImageSize.width=e.options.width,e.selectImageSize.height=e.options.height,e.baseCanvas.width=e.drawingCanvas.width=e.currentWidth,e.baseCanvas.height=e.drawingCanvas.height=e.currentHeight,e.baseContext.drawImage(e.img,0,0,e.currentWidth,e.currentHeight),e.$el.css({height:e.currentHeight,width:e.currentWidth}),e.storedElement=t.storedElement,e.storedUndo=t.storedUndo,e.selectedImage=t.id,e.checkUndoRedo(),e.clear(),e.redraw(),e.annotateresize()}},checkUndoRedo(){this.$tool.children(".annotate-redo").attr("disabled",0===this.storedUndo.length),this.$tool.children(".annotate-undo").attr("disabled",0===this.storedElement.length)},undoaction(t){t.preventDefault();this.storedUndo.push(this.storedElement[this.storedElement.length-1]),this.storedElement.pop(),this.checkUndoRedo(),this.clear(),this.redraw()},redoaction(t){t.preventDefault();this.storedElement.push(this.storedUndo[this.storedUndo.length-1]),this.storedUndo.pop(),this.checkUndoRedo(),this.clear(),this.redraw()},redraw(){const t=this;if(t.baseCanvas.width=t.baseCanvas.width,t.options.images&&t.baseContext.drawImage(t.img,0,0,t.currentWidth,t.currentHeight),0!==t.storedElement.length)for(let e=0;e<t.storedElement.length;e++){const n=t.storedElement[e];if(n)switch(n.type){case"rectangle":t.drawRectangle(t.baseContext,n.fromx,n.fromy,n.tox,n.toy);break;case"arrow":t.drawArrow(t.baseContext,n.fromx,n.fromy,n.tox,n.toy);break;case"pen":for(let e=0;e<n.points.length-1;e++){const o=n.points[e][0],i=n.points[e][1],a=n.points[e+1][0],r=n.points[e+1][1];t.drawPen(t.baseContext,o,i,a,r)}break;case"text":t.drawText(t.baseContext,n.text,n.fromx,n.fromy,n.maxwidth);break;case"circle":t.drawCircle(t.baseContext,n.fromx,n.fromy,n.tox,n.toy)}}},clear(){this.drawingCanvas.width=this.drawingCanvas.width},drawRectangle(t,e,n,o,i){t.beginPath(),t.rect(e,n,o,i),t.fillStyle="transparent",t.fill(),t.lineWidth=this.linewidth,t.strokeStyle=this.options.color,t.stroke()},drawCircle(t,e,n,o,i){const a=.5*(o-e),r=.5*(i-n),s=e+a,d=n+r;let l=.05;const h=2*Math.PI-.05;for(t.beginPath(),t.moveTo(s+a*Math.cos(0),d+r*Math.sin(0));l<h;l+=.05)t.lineTo(s+a*Math.cos(l),d+r*Math.sin(l));t.lineWidth=this.linewidth,t.strokeStyle=this.options.color,t.closePath(),t.stroke()},drawArrow(t,e,n,o,i){const a=Math.atan2(i-n,o-e);t.beginPath(),t.lineWidth=this.linewidth,t.moveTo(e,n),t.lineTo(o,i),t.moveTo(o-5*this.linewidth*Math.cos(a+Math.PI/6),i-5*this.linewidth*Math.sin(a+Math.PI/6)),t.lineTo(o,i),t.lineTo(o-5*this.linewidth*Math.cos(a-Math.PI/6),i-5*this.linewidth*Math.sin(a-Math.PI/6)),t.strokeStyle=this.options.color,t.stroke()},drawPen(t,e,n,o,i){t.lineWidth=this.linewidth,t.moveTo(e,n),t.lineTo(o,i),t.strokeStyle=this.options.color,t.stroke()},wrapText(t,e,n,o,i,a){const r=e.split("\n");for(let e=0;e<r.length;e++){const s=r[e].split(" ");let d="";for(let e=0;e<s.length;e++){const r=`${d+s[e]} `;t.measureText(r).width>i&&e>0?(t.fillText(d,n,o),d=`${s[e]} `,o+=a):d=r}t.fillText(d,n,o+e*a)}},drawText(t,e,n,o,i){t.font=`${this.fontsize} sans-serif`,t.textBaseline="top",t.fillStyle=this.options.color,this.wrapText(t,e,n+3,o+4,i,25)},pushText(){const t=this,e=t.$textbox.val();t.$textbox.val("").hide(),e&&(t.storedElement.push({type:"text",text:e,fromx:t.fromx,fromy:t.fromy,maxwidth:t.tox}),t.storedUndo.length>0&&(t.storedUndo=[])),t.checkUndoRedo(),t.redraw()},selectTool(t){const e=this;e.options.type=t.data("tool"),e.$textbox.is(":visible")&&e.pushText()},annotatestart(t){const e=this;e.clicked=!0;const n=e.$el.offset();if(e.$textbox.is(":visible")){const t=e.$textbox.val();e.$textbox.val("").hide(),""!==t&&(e.tox||(e.tox=100),e.storedElement.push({type:"text",text:t,fromx:(e.fromxText-n.left)*e.compensationWidthRate,fromy:(e.fromyText-n.top)*e.compensationWidthRate,maxwidth:e.tox}),e.storedUndo.length>0&&(e.storedUndo=[])),e.checkUndoRedo(),e.redraw(),e.clear()}e.tox=null,e.toy=null,e.points=[];const o=t.pageX||t.originalEvent.touches[0].pageX,i=t.pageY||t.originalEvent.touches[0].pageY;e.fromx=(o-n.left)*e.compensationWidthRate,e.fromy=(i-n.top)*e.compensationWidthRate,e.fromxText=o,e.fromyText=i,"text"===e.options.type&&e.$textbox.css({left:e.fromxText+2,top:e.fromyText,width:0,height:0}).show(),"pen"===e.options.type&&e.points.push([e.fromx,e.fromy])},annotatestop(){const t=this;if(t.clicked=!1,null!==t.toy&&null!==t.tox){switch(t.options.type){case"rectangle":t.storedElement.push({type:"rectangle",fromx:t.fromx,fromy:t.fromy,tox:t.tox,toy:t.toy});break;case"circle":t.storedElement.push({type:"circle",fromx:t.fromx,fromy:t.fromy,tox:t.tox,toy:t.toy});break;case"arrow":t.storedElement.push({type:"arrow",fromx:t.fromx,fromy:t.fromy,tox:t.tox,toy:t.toy});break;case"text":t.$textbox.css({left:t.fromxText+2,top:t.fromyText,width:t.tox-12,height:t.toy});break;case"pen":t.storedElement.push({type:"pen",points:t.points});for(let e=0;e<t.points.length-1;e++)t.fromx=t.points[e][0],t.fromy=t.points[e][1],t.tox=t.points[e+1][0],t.toy=t.points[e+1][1],t.drawPen(t.baseContext,t.fromx,t.fromy,t.tox,t.toy);t.points=[]}t.storedUndo.length>0&&(t.storedUndo=[]),t.checkUndoRedo(),t.redraw()}else"text"===t.options.type&&t.$textbox.css({left:t.fromxText+2,top:t.fromyText,width:100,height:50})},annotateleave(t){const e=this;e.clicked&&e.annotatestop(t)},annotatemove(t){const e=this;if(e.options.type&&t.preventDefault(),!e.clicked)return;const n=e.$el.offset(),o=t.pageX||t.originalEvent.touches[0].pageX,i=t.pageY||t.originalEvent.touches[0].pageY;switch(e.options.type){case"rectangle":e.clear(),e.tox=(o-n.left)*e.compensationWidthRate-e.fromx,e.toy=(i-n.top)*e.compensationWidthRate-e.fromy,e.drawRectangle(e.drawingContext,e.fromx,e.fromy,e.tox,e.toy);break;case"arrow":e.clear(),e.tox=(o-n.left)*e.compensationWidthRate,e.toy=(i-n.top)*e.compensationWidthRate,e.drawArrow(e.drawingContext,e.fromx,e.fromy,e.tox,e.toy);break;case"pen":e.tox=(o-n.left)*e.compensationWidthRate,e.toy=(i-n.top)*e.compensationWidthRate,e.fromx=e.points[e.points.length-1][0],e.fromy=e.points[e.points.length-1][1],e.points.push([e.tox,e.toy]),e.drawPen(e.drawingContext,e.fromx,e.fromy,e.tox,e.toy);break;case"text":e.clear(),e.tox=(o-e.fromxText)*e.compensationWidthRate,e.toy=(i-e.fromyText)*e.compensationWidthRate,e.$textbox.css({left:e.fromxText+2,top:e.fromyText,width:e.tox-12,height:e.toy});break;case"circle":e.clear(),e.tox=(o-n.left)*e.compensationWidthRate,e.toy=(i-n.top)*e.compensationWidthRate,e.drawCircle(e.drawingContext,e.fromx,e.fromy,e.tox,e.toy)}},annotateresize(){const t=this,e=t.$el.width(),n=t.compensationWidthRate;t.compensationWidthRate=t.selectImageSize.width/e,t.compensationWidthRate<1&&(t.compensationWidthRate=1),t.linewidth=t.options.linewidth*t.compensationWidthRate,t.fontsize=`${String(parseInt(t.options.fontsize.split("px")[0],10)*t.compensationWidthRate)}px`,n!==t.compensationWidthRate&&(t.redraw(),t.clear())},destroy(){t(document).off(this.options.selectEvent,".annotate-image-select"),this.$textbox.remove(),this.$el.children("canvas").remove(),this.$el.removeData("annotate")},exportImage(e,n){const o=this;o.$textbox.is(":visible")&&o.pushText();e=t.extend({},{type:"image/jpeg",quality:.75},e);const i=o.baseCanvas.toDataURL(e.type,e.quality);n&&n(i),o.options.onExport(i)}},t.fn.annotate=function(n,o,i){const a=t(this).data("annotate");if("destroy"===n){if(!a)throw new Error(`No annotate initialized for: #${t(this).attr("id")}`);a.destroy()}else if("push"===n){if(!a)throw new Error(`No annotate initialized for: #${t(this).attr("id")}`);a.pushImage(o,!0,i)}else if("fill"===n){if(!a)throw new Error(`No annotate initialized for: #${t(this).attr("id")}`);a.addElements(o,!0,i)}else if("export"===n){if(!a)throw new Error(`No annotate initialized for: #${t(this).attr("id")}`);a.exportImage(o,i)}else{const o=t.extend({},t.fn.annotate.defaults,n),i=new e(t(this),o);t(this).data("annotate",i)}},t.fn.annotate.defaults={width:null,height:null,images:[],color:"red",type:"rectangle",linewidth:2,fontsize:"20px",idAttribute:"id",selectEvent:"change",onExport:()=>{}}}(function(t){return t&&t.__esModule?t:{default:t}}(n(152)).default)}}]);